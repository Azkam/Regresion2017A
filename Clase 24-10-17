# ESTATURAS       1.2,1.23,1.19,1.32,1.28,1.22,1.17,1.29,1.33,1.15
# NIVEL ECONOMICO 110,130,108,167,156,115,104,138,170,107
#QUEREMOS COMPROBAR LA HIPOTESISI QUE ENTRE MAYOR INGRESO DE LA FAMILIA HAY UNA MAYOR
#ESTATURA EN LOS NIÑOS
esta <- c(1.2,1.23,1.19,1.32,1.28,1.22,1.17,1.29,1.33,1.15)
eco<-c(110,130,108,167,156,115,104,138,170,107)
mod1<-lm(esta~eco)

#BONDAD DE AJUSTE 
##CON LA BONDAD DE AJUSTE VERIFICAMOS LA CALIDAD DEL MODELO AL INTERPRETAR LA VARIABLE DEPENDENDIENTE
#PARA ESO SE UTILIZA LA TABLA ANOVA

anova(mod1)
#EN ESTE CASI KA VARIABILIDAD EXPLICADA DEL MODELO ES .033022=5.5M 
#SE REVISA LA SSR=.0031
#REVISANDO LOS VALORES DEL SUMMARY EL ESTADISTICO F ES MAYOR A 1 Y P-VALUE < 0.05 CON 
#ESTAS REVISIONES SE PUEDE MENCIONAR QUE SE RECHAZA LA HIPOTESISI NULA DE F=1 Y SE PUEDE
#ESTABLECER UN MODELO 

#REVISAR R2 MULTIPLE 
#AL REDEDOR DEL 91% DE LA VARIABILIDAD DE LA ESTATURA ES EXPLICADA POR A RETA AJUSTADA 
summary(mod1)$coefficients
#ESTA =.9323+.0023 eco

####ANALISIS DE LOS COEFICIENTES
#B0 ES .93 Y B1 ES .0023 SI LA VARIBLE INGRESO INCREMENTA EN UN PESO LA ESTATURA DEL NIÑO
#INCREMENTA .0023

#DIAGNOSTICO DEL MODELO 

base1 <- data.frame(eco,esta)
base1$fitted.mod1 <- fitted(mod1) ##VALORES AJUSTADOS
base1$residuals.mod1 <- residuals(mod1) #RESIDUOS DEL MODELO
base1$rstudent.mod1 <- rstudent(mod1) #RESIDUOS STUDENTIZADOS

#ESTAS VARIABLES SE UTILIZAN PARA COMPROBAR LOS SUPUESTOS..
##SUPUESTOS DE NORMALIDAD ... ES QUE LOS RESIDUOS TENGAN UNA DISTRIBUCION NORMAL 
#PARA CONOCER LA NORMALIDAD SE UTILIZA LA PRUEBA DE SHAPIRO PARA ANALISAR LSO RESIDUOS 
shapiro.test(base1$rstudent.mod1)
#PRUEBA DE HGIPOTESIS SHAPIRO TEST
##H0: LA MUESTRA TIENE UNA DISTRIBUCION NORMAL 
##Ha: LA MUESTRA NO TIENE UNA DISTRIBUCION NORMAL 

#TENEMOS UN PVALUE DE .8172 NO SE RECHAZA LA HIPOTESIS NULA
#POR LO TANTO SE ACEPTA QUE HAY NORMALIDAD 
#AHORA VEREMOS ESTE RESULTADO EN UNA GRAFICA 
x11()
qqnorm(base1$rstudent.mod1,main="NORMAL (0,1)") # SE OBTIENE GRAFICA DE 
qqline(base1$rstudent.mod1)
#AHORA VAMOS A REVISAR LA HOMOGENEIDAD DE VARIANZA 
#PARA LA HOMOGENEIDAD SE REQUIERE SE UNA LIBREIRA QUE SE LLAMA LMTEST, DEBIDO A QUE ESTA
#SE TIENE QUE APLICAR LA PRUEBA BREUSCH-PAGAN TEST
install.packages("lmtest")
require(lmtest)
bqtest(mod1)

# EN ESTA PRUEBA ESPERAMOS QUE HAYA HOMOGENEIDAD DE LA VARINZA PARA ESTO TENEMOS QUE TENER
#UN PVALUE MAYOR A .05, POR LO QUE PARA MOD1 SE PUEDE DECIR QUE HAY HOMOGENEIDAD EN LA 
#VARIABLE PRIEBA DE AUTORRELACION O INDEPENDENCIA EN ESTE CASO SE UTILIZA LA PRUEBA DE 
#DURBIN WATSON

dwtest(mod1,alternative="two.sided")

#EN ESTE CASO AL IGUAL QUE LOS DEMAS SE ACEPTA HIPOTESIS NULA DEBIDO A QUE TENEMOS UN PVALUE
#MAYOR A .05.... ESTO QUIERE DECIR QUE NO HAY AUTOCORRELACION EN LOS RESIDUOS
